#!/bin/bash\n\n# GuruChat MERN Setup & Run Script\n# ----------------------------------\n# This script automates the setup process for local development\n# on macOS and Windows (using Git Bash or WSL).\n#\n# Usage:\n# 1. Clone the repository.\n# 2. Navigate to the project root directory.\n# 3. Make the script executable: chmod +x scripts/setup-and-run.sh\n# 4. Run the script: ./scripts/setup-and-run.sh\n\n# Exit immediately if a command exits with a non-zero status.\nset -e\n\n# --- Helper Function to Check Command Existence ---\ncheck_command() {\n  COMMAND_NAME=$1\n  INSTALL_CMD=$2\n  INSTALL_URL=$3\n\n  if ! command -v \"$COMMAND_NAME\" &> /dev/null; then\n    echo \"ERROR: \`$COMMAND_NAME\` command not found.\"\n    echo \"Please install it.\"\n    if [[ -n \"$INSTALL_CMD\" ]]; then\n      echo \"Common install command: $INSTALL_CMD\"\n    fi\n    if [[ -n \"$INSTALL_URL\" ]]; then\n      echo \"More info: $INSTALL_URL\"\n    fi\n    exit 1\n  fi\n  echo \"- \`$COMMAND_NAME\` found.\"\n}\n\n# --- 1. Check Prerequisites ---\necho \"[1/6] Checking Prerequisites...\"\ncheck_command \"node\" \"(various methods)\" \"https://nodejs.org/\"\ncheck_command \"pnpm\" \"npm install -g pnpm\" \"https://pnpm.io/installation\"\ncheck_command \"git\" \"(various methods)\" \"https://git-scm.com/book/en/v2/Getting-Started-Installing-Git\"\ncheck_command \"jq\" \"brew install jq / sudo apt-get install jq / choco install jq\" \"https://stedolan.github.io/jq/download/\"\ncheck_command \"openssl\" \"(usually pre-installed)\" \"(Needed for JWT secret generation)\"\necho \"Prerequisites check complete.\"\n\n# --- 2. Install Dependencies ---\necho \"\\n[2/6] Installing dependencies using pnpm...\"\npnpm install\necho \"Dependencies installed.\"\n\n# --- 3. Configure Environment Variables ---\necho \"\\n[3/6] Configuring environment variables (.env.local)...\"\nENV_FILE=\".env.local\"\n\nif [ -f \"$ENV_FILE\" ]; then\n  echo \"- \`$ENV_FILE\` already exists.\"\n  read -p \"Do you want to overwrite it? (y/N): \" OVERWRITE_ENV\n  if [[ ! \"$OVERWRITE_ENV\" =~ ^[Yy]$ ]]; then\n    echo \"Skipping environment variable setup.\"\n  else\n    echo \"Overwriting \`$ENV_FILE\`...\"\n    > \"$ENV_FILE\" # Clear the file before writing\n  fi\nfi\n\n# Check if file needs content (either non-existent or overwrite approved)\nif [ ! -f \"$ENV_FILE\" ] || [[ \"$OVERWRITE_ENV\" =~ ^[Yy]$ ]]; then\n    # Prompt for MONGODB_URI\n    while [ -z \"$MONGODB_URI\" ]; do\n        read -p \"Enter your MongoDB Connection URI: \" MONGODB_URI\n        if [ -z \"$MONGODB_URI\" ]; then\n            echo \"MongoDB URI cannot be empty. Please try again.\"\n        fi\n    done\n    echo \"MONGODB_URI=\\\"$MONGODB_URI\\\"\" >> \"$ENV_FILE\"\n    echo \"- MONGODB_URI added.\"\n\n    # Prompt for GOOGLE_AI_API_KEY\n    while [ -z \"$GOOGLE_AI_API_KEY\" ]; do\n        read -p \"Enter your Google AI API Key: \" GOOGLE_AI_API_KEY\n        if [ -z \"$GOOGLE_AI_API_KEY\" ]; then\n            echo \"Google AI API Key cannot be empty. Please try again.\"\n        fi\n    done\n    echo \"GOOGLE_AI_API_KEY=\\\"$GOOGLE_AI_API_KEY\\\"\" >> \"$ENV_FILE\"\n    echo \"- GOOGLE_AI_API_KEY added.\"\n\n    # Generate JWT_SECRET\n    echo \"Generating secure JWT_SECRET...\"\n    JWT_SECRET=$(openssl rand -hex 32)\n    echo \"JWT_SECRET=\\\"$JWT_SECRET\\\"\" >> \"$ENV_FILE\"\n    echo \"- JWT_SECRET generated and added.\"\n    \n    echo \"\`$ENV_FILE\` created successfully.\"\nfi\n\n# --- 4. Seed Database ---\necho \"\\n[4/6] Seeding the database with sample Guru data...\"\npnpm run seed:gurus\necho \"Database seeded.\"\n\n# --- 5. Check/Install Vercel CLI ---\necho \"\\n[5/6] Checking for Vercel CLI...\"\nif ! command -v vercel &> /dev/null; then\n  echo \"Vercel CLI not found. Installing globally via pnpm...\"\n  pnpm install -g vercel\n  echo \"Vercel CLI installed.\"\nelse\n  echo \"- \`vercel\` found.\"\nfi\n\n# --- 6. Run Development Server ---\necho \"\\n[6/6] Starting the development server using Vercel CLI...\"\necho \"The server will load environment variables from .env.local.\"\necho \"Access the application at http://localhost:3000 (or the address shown).\"\necho \"Press Ctrl+C in the terminal to stop the server.\"\necho \"----------------------------------------------------\"\nvercel dev\n\n# Script finishes when vercel dev is stopped\necho \"\\nSetup complete. Vercel dev server stopped.\"\n 